# hash函数 - 比特币挖矿

2013年10月5号，比特币价格121美元，在北京的车库咖啡，我友好地拒绝了21岁的美国小伙儿Jake转给我0.1个比特币的提议。2021年2月8日，比特币价格39200美元，Jake也成为了比特币社区领袖。

```
弱小和无知不是生存障碍，傲慢才是。
                            —— 刘慈欣《三体》
```

虽然失去了通过比特币通向财务自由之路的机会，但与Jake的相遇让我对比特币背后的技术产生了兴趣。我们至今不知道比特币的发明者中本聪（Satoshi Nakamoto）是谁，但不得不惊叹于他精巧的构思。比特币并没有使用任何新技术，而是使用了已经在互联网领域广泛应用的安全散列算法（Secure Hash Algorithm）和非对称密码学(Asymmetric cryptography)。


```
安全散列算法2（Secure Hash Algorithm 2）由美国国家标准与技术研究院（NIST）在2001年发布，有6个不同的算法标准，比特币选用了SHA-256
```


```
非对称密码学（Asymmetric cryptography）的RSA加密算法由麻省理工学院的Rivest，Shamir和Adleman在1977年提出。比特币使用的非对称密码学是1985年提出的椭圆曲线密码学（Elliptic Curve Cryptography）。
```


SHA-256函数可以做什么呢？如果我们把一句话输入到这个函数里，会得到一串没有任何意义的字母和数字的组合

```
sha256(月上柳梢头,人约黄昏后) => 

098f50a007bdbd695c5929784636bd27e657e6ad8202b23fce3f93bc62806499

```


如果我们把这句话改一下

```
sha256(月上柳梢头,别约黄昏后) =>

9ce0df227bb6215fe7d9be25937e643a84d3bd6452c16ef26b1cf48b943d24c2
```


可以看到，经过sha256函数的处理，两句话虽然只改了一个字，但得到的结果（术语叫摘要digest）却完全不同。这对于防止信息篡改非常重要。

对原文的任何一点小的篡改，都会导致摘要(digest)翻天覆地的变化，因此只需要验证摘要（digest），就可以知道信息有没有被篡改。如果原文很长，sha256还是会生成一个固定长度的摘要(digest)，大大方便了我们的验证工作。


每隔10分钟左右，比特币的网络里会产生一些交易记录。而矿工要做的，就是找到一个随机数。这个随机数字和交易记录结合后的信息，经过sha256运算，得到以多个数字0为开头的摘要。数字0的个数，由比特币网络动态决定。


sha256运算对于计算机来说非常容易，家用电脑也可以在毫秒间算出结果。但我们知道输入到sha256的信息略作改变，得到的摘要就会完全不同。怎么让摘要的前几位都是0呢？只能试，不断地试。每试一次，就是选一个随机数和交易记录一起做sha256运算。通常要试亿万次，才能找到那个满足条件的数。

谁最先找到满足条件的数，谁就能得到比特币奖励。谁的算力强大，谁就可能最先找到满足条件的数。

比特币挖矿是一个体力活，计算过程由GPU完成，要消耗大量的电能。对于算力的消耗，或者对于电能的消耗，就是工作量的证明，在比特币中叫做Proof of Work（工作量证明）。

```
GPU就像100个小学生，CPU就像1个大学生。如果要解微分方程，100个小学生也比不过1个大学生。但是如果要计算1000道算术题，100个小学生每人做10道题，而1个大学生要1个人做1000道题，1个大学生的速度会远远落后于100个小学生的速度。sha256的内部计算非常简单，但是需要试非常多此，这就是为什么矿工要用GPU挖矿。
```

黄金是稀有的，黄金的开采很难。

2021年2月8日，每克黄金的价格是58.31美元。


黄金并不能吃，在工业中的应用只占黄金储量的很小一部分，为什么每克黄金值58.31美元？


因为几乎所有人都愿意用58.31美元换1克黄金，世界上绝大多数人达成了共识。



当所有人达成共识，那么黄金的价格就确定了。


比特币也是稀有的（比特币网络一共会产生2100万个比特币），比特币的挖矿很难。

对于比特币的价值，我们还需要等待，等待世界上绝大多数人达成共识。