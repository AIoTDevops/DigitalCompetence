## 数字签名 - 如何证明我是我

张生和崔莺莺要想成功约会，不仅要学会对信息进行加密，还要学会数字签名


崔莺莺把自己的锁（公钥 Public Key）告诉了大家，所有人都知道了 n 和 e

崔莺莺的妈妈也有了n和e，于是她给崔莺莺发了一条加密信息

崔莺莺收到加密信息，计算PHI(n)，用PHI(n)和e计算出钥匙d，用n和d解密，“我是张生，今晚不能去赴约了”


那今晚张生到底来不来呢？

## 用SHA256函数和RSA非对称加密算法为张生制作数字签名

1. 张生制作自己的锁（公钥）和钥匙（私钥）
2. 张生把锁分发给了大家
3. 张生通过SHA256获得自己信息的摘要（digest）

> sha256(月上柳梢头,人约黄昏后) => 
>
> 098f50a007bdbd695c5929784636bd27e657e6ad8202b23fce3f93bc62806499

4. 张生用自己的钥匙（私钥）把摘要（digest）加密，这就是张生对“月上柳梢头,人约黄昏后”的数字签名


## 张生用崔莺莺的锁（公钥）把信息加密
> 张生用崔莺莺的公钥（n和e）把“月上柳梢头,人约黄昏后”加密


## 张生把数字签名和加密信息发给崔莺莺，莺莺收到后

1. 崔莺莺把加密信息解密（用n和自己的私钥d）
2. 看到“月上柳梢头,人约黄昏后”，脸上泛起红晕
> 这句话到底是不是张生说的呢？
3. 崔莺莺用SHA256获取信息的摘要（digest）

> sha256(月上柳梢头,人约黄昏后) => 
>
> 098f50a007bdbd695c5929784636bd27e657e6ad8202b23fce3f93bc62806499


> 在收到张生密信的同时，崔莺莺也收到了张生的数字签名（张生用自己的钥匙对摘要加密）
4. 崔莺莺用张生的锁（公钥）解密经过加密的摘要
> 098f50a007bdbd695c5929784636bd27e657e6ad8202b23fce3f93bc62806499

5. 崔莺莺对比数字签名解密后的摘要和收到信息的摘要，确认两个摘要是一样的，可以确定“月上柳梢头,人约黄昏后”是张生说的，于是开始梳妆打扮起来


## 张生的锁（公钥）大家都有，崔莺莺的妈妈也有

> 崔莺莺的妈妈拿到了数字签名，用张生的锁解密，只能得到一个摘要
>  098f50a007bdbd695c5929784636bd27e657e6ad8202b23fce3f93bc62806499
> 崔莺莺的妈妈只知道张生给女儿发了信息，却不知道他们什么时间约会


## 崔莺莺的妈妈给崔莺莺写了一封信

1. “我是张生，今晚不能去赴约了”

2. 制作摘要
> sha256(我是张生，今晚不能去赴约了)=> 
> dddf48c7c08e657734f8fe486026cd72ad88505f6ba693357d30fa6618425677
3. 用自己的钥匙（私钥）给摘要加密，制作数字签名


## 崔莺莺收到了伪造的信，和崔莺莺妈妈的数字签名

1. “我是张生，今晚不能去赴约了”,制作digest
2. 用张生的锁（公钥）解密崔莺莺妈妈的数字签名，得到一个digest
3. 对比两个digest发现不一样
4. 崔莺莺知道，这封信不是张生写的，于是继续梳妆打扮


## 用张生私钥加密摘要，得到的就是张生的数字签名
## 用张生公钥解密数字签名，得到信息的摘要

> RSA 数字签名
> 张生有自己的钥匙（私钥d）和 n
> signature = digest ^ d mod n
> 数字签名就是 digest 的 d 次方 除 n 的余数
>
> 崔莺莺知道张生的锁（公钥 e）和 n
> digest = signature ^ e mod n
> 摘要就是 signature 的 e 次方 除 n 的余数

